"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var toString=function(e){return Object.prototype.toString.call(e)},hasSymbol="function"==typeof Symbol&&Symbol.for,noopFn=function(e){return e},hasOwnProperty=Object.prototype.hasOwnProperty;function hasOwn(e,t){return hasOwnProperty.call(e,t)}function assert(e,t){if(!e)throw new Error("[vue-function-api] "+t)}function isArray(e){return"[object Array]"===toString(e)}function isPlainObject(e){return"[object Object]"===toString(e)}var currentVue=null,currentVM=null;function getCurrentVue(){return currentVue}function setCurrentVue(e){currentVue=e}function getCurrentVM(){return currentVM}function setCurrentVM(e){currentVM=e}var AbstractWrapper=function(){function e(){}return e.prototype.setPropertyName=function(e){this._name=e},e}(),extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function __extends(e,t){function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},ValueWrapper=function(e){function t(t){var r=e.call(this)||this;return r._interal=t,r}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._interal.$$state},set:function(e){this._interal.$$state=e},enumerable:!0,configurable:!0}),t}(AbstractWrapper),ComputedWrapper=function(e){function t(t){var r=e.call(this)||this;return r._interal=t,r}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._interal.read()},set:function(e){this._interal.write&&this._interal.write(e)},enumerable:!0,configurable:!0}),t}(AbstractWrapper);function isWrapper(e){return e instanceof AbstractWrapper}function ensuerCurrentVMInFn(e){return getCurrentVM()}function observable(e){var t=getCurrentVue();if(t.observable)return t.observable(e);var r=t.config.silent;t.config.silent=!0;var n=new t({data:{$$state:e}});return t.config.silent=r,n._data.$$state}function compoundComputed(e){var t=getCurrentVue(),r=t.config.silent;t.config.silent=!0;var n=new t({computed:e});return t.config.silent=r,n}function mergeData(e,t){if(!t)return e;for(var r,n,o,u=hasSymbol?Reflect.ownKeys(t):Object.keys(t),a=0;a<u.length;a++)"__ob__"!==(r=u[a])&&(n=e[r],o=t[r],hasOwn(e,r)?n!==o&&isPlainObject(n)&&!isWrapper(n)&&isPlainObject(o)&&!isWrapper(n)&&mergeData(n,o):e[r]=o);return e}function install(e,t){currentVue&&currentVue===e||(e.config.optionMergeStrategies.setup=function(e,t){return function(r){return mergeData("function"==typeof t&&t.call(this,r)||{},"function"==typeof e&&e.call(this,r)||{})}},setCurrentVue(e),t(e))}function mixin(e){e.mixin({created:function(){var e=this,t=e.$options.setup;if(t){var r;try{setCurrentVM(e),r=t.call(e,e.$props)}catch(e){console.log(e)}finally{setCurrentVM(null)}if(!r)return;Object.keys(r).forEach(function(t){var n=r[t];isWrapper(n)?(n.setPropertyName(t),proxy(e,t,function(){return n.value},function(e){n.value=e})):e[t]=n})}}})}var sharedPropertyDefinition={enumerable:!0,configurable:!0,get:noopFn,set:noopFn};function proxy(e,t,r,n){sharedPropertyDefinition.get=r,sharedPropertyDefinition.set=n||noopFn,Object.defineProperty(e,t,sharedPropertyDefinition)}function upWrapping(e){for(var t=Object.keys(e),r=0;r<t.length;r++){var n=t[r],o=e[n];isWrapper(o)?e[n]=o.value:(isPlainObject(o)||isArray(o))&&(e[n]=upWrapping(o))}return e}function state(e){return observable(upWrapping(e))}function value(e){return new ValueWrapper(observable({$$state:upWrapping(e)}))}var genName=function(e){return"on"+(e[0].toUpperCase()+e.slice(1))};function createLifeCycle(e){return function(t){ensuerCurrentVMInFn(genName(e)).$on("hook:"+e,t)}}function createLifeCycles(e,t){return function(r){var n=ensuerCurrentVMInFn(t);e.forEach(function(e){return n.$on("hook:"+e,r)})}}var onCreated=createLifeCycle("created"),onBeforeMount=createLifeCycle("beforeMount"),onMounted=createLifeCycle("mounted"),onBeforeUpdate=createLifeCycle("beforeUpdate"),onUpdated=createLifeCycle("updated"),onActivated=createLifeCycle("activated"),onDeactivated=createLifeCycle("deactivated"),onBeforeDestroy=createLifeCycle("beforeDestroy"),onDestroyed=createLifeCycle("destroyed"),onErrorCaptured=createLifeCycle("errorCaptured"),onUnmounted=createLifeCycles(["destroyed","deactivated"],genName("unmounted"));function createSymbol(e){return hasSymbol?Symbol.for(e):e}var WatcherPreFlushQueueKey=createSymbol("vfa.key.preFlushQueue"),WatcherPostFlushQueueKey=createSymbol("vfa.key.postFlushQueue");function hasWatchEnv(e){return void 0!==e[WatcherPreFlushQueueKey]}function installWatchEnv(e){e[WatcherPreFlushQueueKey]=[],e[WatcherPostFlushQueueKey]=[],e.$on("hook:beforeUpdate",createFlusher(WatcherPreFlushQueueKey)),e.$on("hook:updated",createFlusher(WatcherPostFlushQueueKey))}function createFlusher(e){return function(){flushQueue(this,e)}}function flushQueue(e,t){for(var r=e[t],n=0;n<r.length;n++)r[n]();r.length=0}function flushWatcherCallback(e,t,r){function n(){e.$nextTick(function(){e[WatcherPreFlushQueueKey].length&&flushQueue(e,WatcherPreFlushQueueKey),e[WatcherPostFlushQueueKey].length&&flushQueue(e,WatcherPostFlushQueueKey)})}switch(r){case"pre":n(),e[WatcherPreFlushQueueKey].push(t);break;case"post":n(),e[WatcherPostFlushQueueKey].push(t);break;case"auto":case"sync":t();break;default:assert(!1,'flush must be one of ["post", "pre", "sync"], but got '+r)}}function createSingleSourceWatcher(e,t,r,n){var o;o=isWrapper(t)?function(){return t.value}:t;var u=function(e,t){u=a,n.lazy?a(e,t):r(e,t)},a=function(t,o){flushWatcherCallback(e,function(){r(t,o)},n.flush)};return e.$watch(o,function(e,t){u(e,t)},{immediate:!n.lazy,deep:n.deep,sync:"sync"===n.flush})}function createMuiltSourceWatcher(e,t,r,n){var o=!n.lazy&&t.length,u=!1,a=[];function i(){r.apply(e,a.reduce(function(e,t){return e[0].push(t.value),e[1].push(t.oldValue),e},[[],[]]))}var c=function(){!1!==o?0==--o&&(o=!1,c=s,i()):(c=s,s())},s=function(){u||(u=!0,flushWatcherCallback(e,function(){u=!1,i()},n.flush))};return t.forEach(function(t){var r;r=isWrapper(t)?function(){return t.value}:t;var o={};a.push(o),o.watcherStopHandle=e.$watch(r,function(e,t){o.value=e,o.oldValue=t,c()},{immediate:!n.lazy,deep:n.deep,sync:"sync"===n.flush})}),function(){a.forEach(function(e){return e.watcherStopHandle()})}}function watch(e,t,r){void 0===r&&(r={});var n=__assign({lazy:!1,deep:!1,flush:"post"},r),o=getCurrentVM();if(!o){var u=getCurrentVue(),a=u.config.silent;u.config.silent=!0,o=new u,u.config.silent=a,n.flush="auto"}return hasWatchEnv(o)||installWatchEnv(o),isArray(e)?createMuiltSourceWatcher(o,e,t,n):createSingleSourceWatcher(o,e,t,n)}function computed(e,t){var r=compoundComputed({$$state:t?{get:e,set:t}:e});return new ComputedWrapper({read:function(){return r.$$state},write:function(e){r.$$state=e}})}function resolveInject(e,t){for(var r=t;r;){if(r._provided&&hasOwn(r._provided,e))return r._provided[e];r=r.$parent}}function provide(e){if(e){var t=ensuerCurrentVMInFn("provide");t._provided="function"==typeof e?e.call(t):e}}function inject(e){if(e)return resolveInject(e,ensuerCurrentVMInFn("inject"))}var _install=function(e){return install(e,mixin)},plugin={install:_install};currentVue&&"undefined"!=typeof window&&window.Vue&&_install(window.Vue),exports.computed=computed,exports.inject=inject,exports.onActivated=onActivated,exports.onBeforeDestroy=onBeforeDestroy,exports.onBeforeMount=onBeforeMount,exports.onBeforeUpdate=onBeforeUpdate,exports.onCreated=onCreated,exports.onDeactivated=onDeactivated,exports.onDestroyed=onDestroyed,exports.onErrorCaptured=onErrorCaptured,exports.onMounted=onMounted,exports.onUnmounted=onUnmounted,exports.onUpdated=onUpdated,exports.plugin=plugin,exports.provide=provide,exports.state=state,exports.value=value,exports.watch=watch;
